django-handlebars
=================
django-handlebars integrates [Handlebars](http://handlebarsjs.com/) JavaScript templating engine with [Django](https://www.djangoproject.com/). It provides python and JavaScript helpers for wrapping basic routines as templates inclusion and loading. Optionaly django-handlebars provides `manage.py` commands for templates pre-compilation (requires `python-spidermonkey`) and live compilation as you developing (requires `pyinotify`).

How to install
--------------
1. Install package from PyPi `pip install django-handlebars`. Or alternatively pull the repo and run `python setup.py install`
2. Add `django_handlebars` to project's `settings.INSTALLED_APPS`
3. Optionaly add `HANDLEBARS_*` configuration parameters to the `settings.py`. See `django_handlebars.appsettings` for available options and explanations
4. Run `./manage.py test handlebars.SettingsTest` to check your configuration
5. That should be it. Application is not providing any models or URLs.

How to use
----------
django-handlebars can work in two modes: compiling templates in browser and rendering templates pre-compiled on server side. In both scenarios templates might be loaded dynamically with AJAX request or included on page to prevent extra HTTP requests.

First you have to drop in Handlebars scripts on page

```html
{% load handlebars_tags %}
<html>
<head>
	{% handlebars_scripts %}
</head>
<body></body>	
</html>
```
Which will add `handlebars_config` variable storing configuration, `script` tags for `handlebars.js` (or `handlebars.runtime.js` if `settings.HANDLEBARS_COMPILED` is True) and handlebars.django.js. Django-handlebars provides template loading client (see handlebars.django.js) by extending Handlebars object with tpl() method.

### Compiling in browser
This mode is simpler and doesn't require optional dependencies to be satisfied. But it adds a little overhead. In this case Handlebars will parse  template every other page load and parser script has to be loaded in addition to renderer.

Assuming you have configured application and your Handlebars *.html templates are accessiable from static URL, your typical usage pattern will look like this:

```js
var data = {title: "The title", body: "whatever"}

Handlebars.tpl("your/template/spec", {
    success: function(renderer){
        console.log("Rendered template:", renderer(data));
    },
    error: function(xhr, err){
        console.warn("Ooops, can't load template", err);
    }
});
```

Notice that template path doesn't include dir URL and extension. Starting slash is tolerated. `Handlebars.tpl` is NOT returning template, having `success` callback is the only way to get it.

By default client attempts to use [jQuery](https://github.com/jquery/jquery) if it's available, otherwise it will fall back to it's own simple crossbrowser XHR implementation. In case jQuery is available `Handlebars.tpl()` call would return jQuery.Deferred object, so chaining and other benefits may be used:

```js
var df = Handlebars.tpl("your/template/spec");

df.done(function(renderer){
    console.log("Rendered template:", renderer(data));
}).fail(function(xhr, err){
    console.warn("Ooops, can't load template", err);
});
```

Loader appends .html extension and pulls file from `settings.HANDLEBARS_TPL_URL`

### Using pre-compiled templates
In this mode your JavaScript code stays same, but client will attempt to pull .js file from `settings.HANDLEBARS_TPL_URL`. Pre-compiled file contains JS function generated by `Handlebars.precompile(str_template)`. You can run this command right in a browser console to see how it looks like. Django-handlebars provides manage.py commands to build those files in a batch.

### Eliminating extra requests
In both cases described above HTTP request will be made which adds some performance disadvantage. To avoid that include you templates on page:

```html
{% handlebars_template "your/template/spec" %}
```

This will cache template by calling `Handlebars.tpl("your/template/spec", tpl)`. This technic works for both regular and pre-compiled modes.

License
-------
&copy; 2012 Sergii Iavorskyi, Licensed new-style BSD. Contains [Handlebars.js](https://github.com/wycats/handlebars.js) &copy; 2011 Yehuda Katz. See LICENSE file for more information.

